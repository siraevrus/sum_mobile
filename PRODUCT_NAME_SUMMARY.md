# üìù –ö–†–ê–¢–ö–û–ï –†–ï–ó–Æ–ú–ï: –°–æ–∑–¥–∞–Ω–∏–µ –∏–º—ë–Ω —Ç–æ–≤–∞—Ä–æ–≤

## ‚ùì –í–û–ü–†–û–°
–ö–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –∏–º–µ–Ω–∏ (name) –≤ —Ä–∞–∑–¥–µ–ª–µ –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏ –¢–æ–≤–∞—Ä—ã –≤ –ø—É—Ç–∏? –í —á–µ–º –æ—Ç–ª–∏—á–∏—è?

---

## ‚úÖ –û–¢–í–ï–¢

### üéØ –ì–õ–ê–í–ù–´–ô –í–´–í–û–î
**–ê–ª–≥–æ—Ä–∏—Ç–º —Å–æ–∑–¥–∞–Ω–∏—è –∏–º—ë–Ω –ò–î–ï–ù–¢–ò–ß–ï–ù –≤ –æ–±–æ–∏—Ö —Ä–∞–∑–¥–µ–ª–∞—Ö, –Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏.**

---

## üìä –°–†–ê–í–ù–ï–ù–ò–ï –í 5 –ü–£–ù–ö–¢–ê–•

### 1Ô∏è‚É£ –ê–õ–ì–û–†–ò–¢–ú –°–û–ó–î–ê–ù–ò–Ø (–û–î–ò–ù–ê–ö–û–í–´–ô)

```
–§–æ—Ä–º—É–ª–∞ –∏–º–µ–Ω–∏: [–ù–∞–∑–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞]: [–ê—Ç—Ä–∏–±—É—Ç—ã —Ñ–æ—Ä–º—É–ª—ã x], [–û—Å—Ç–∞–ª—å–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã]

–ü—Ä–∏–º–µ—Ä: "–î–æ—Å–∫–∞: 20 x 30, –°–æ—Å–Ω–∞"
```

**–®–∞–≥–∏:**
1. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∞—Ç—Ä–∏–±—É—Ç—ã —Ç–æ–≤–∞—Ä–∞ –∏–∑ —à–∞–±–ª–æ–Ω–∞
2. –†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –¥–≤–µ –≥—Ä—É–ø–ø—ã:
   - `isInFormula = true` ‚Üí –∞—Ç—Ä–∏–±—É—Ç—ã —Ä–∞–∑–º–µ—Ä–æ–≤ (20, 30) ‚Üí —Å–æ–µ–¥–∏–Ω—è—é—Ç—Å—è —Å ` x `
   - –æ—Å—Ç–∞–ª—å–Ω–æ–µ (material) ‚Üí —Å–æ–µ–¥–∏–Ω—è—é—Ç—Å—è —Å `, `
3. –°–æ–±—Ä–∞—Ç—å: `[–ù–∞–∑–≤–∞–Ω–∏–µ]: [—Ä–∞–∑–º–µ—Ä—ã], [–º–∞—Ç–µ—Ä–∏–∞–ª]`

### 2Ô∏è‚É£ –•–†–ê–ù–ï–ù–ò–ï –î–ê–ù–ù–´–• (–û–¢–õ–ò–ß–ò–ï ‚Ññ1)

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ | –¢–æ–≤–∞—Ä—ã –≤ –ø—É—Ç–∏ |
|----------|------------------|-----------------|
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ | 1 —Ç–æ–≤–∞—Ä | N —Ç–æ–≤–∞—Ä–æ–≤ |
| –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö | –û—Ç–¥–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ | `List<ProductFormData>` |
| –û—Ç–∫—É–¥–∞ –±–µ—Ä—ë–º –∏–º—è | `_nameController.text` | `_products[index].name` |

**–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:**
```dart
class _ProductInflowFormPageState {
  ProductTemplateModel? _selectedTemplate;  // 1 —à–∞–±–ª–æ–Ω
  Map<String, TextEditingController> _attributeControllers = {};  // –î–ª—è 1 —Ç–æ–≤–∞—Ä–∞
  TextEditingController _nameController;  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
}
```

**–¢–æ–≤–∞—Ä—ã –≤ –ø—É—Ç–∏:**
```dart
class _ProductInTransitFormPageState {
  List<ProductFormData> _products = [];  // –ú–∞—Å—Å–∏–≤ —Ç–æ–≤–∞—Ä–æ–≤!
  
  class ProductFormData {
    ProductTemplateModel? template;  // –®–∞–±–ª–æ–Ω –¥–ª—è THIS —Ç–æ–≤–∞—Ä–∞
    Map<String, TextEditingController> attributeControllers;  // –ê—Ç—Ä–∏–±—É—Ç—ã THIS —Ç–æ–≤–∞—Ä–∞
    String name;  // –ò–º—è THIS —Ç–æ–≤–∞—Ä–∞
  }
}
```

### 3Ô∏è‚É£ –í–´–ó–û–í –§–£–ù–ö–¶–ò–ò –ü–ï–†–ï–°–ß–Å–¢–ê (–û–¢–õ–ò–ß–ò–ï ‚Ññ2)

**–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:**
```dart
// –ü—Ä–∏ –ª—é–±–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏
void _onAttributeChanged() {
  _calculateNameAndVolume();  // –ë–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
}

void _generateProductName() {
  // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç _attributeControllers (–æ–¥–∏–Ω –Ω–∞–±–æ—Ä –¥–ª—è –æ–¥–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞)
  for (final attribute in _selectedTemplate!.attributes) {
    final value = _attributeControllers[attribute.variable]?.text ?? '';
  }
}
```

**–¢–æ–≤–∞—Ä—ã –≤ –ø—É—Ç–∏:**
```dart
// –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞ N
void _onProductAttributeChanged(TextEditingController controller) {
  // –ò—â—ë–º –∫–∞–∫–æ–π —Ç–æ–≤–∞—Ä –∏–∑–º–µ–Ω–∏–ª—Å—è
  for (int i = 0; i < _products.length; i++) {
    if (_products[i].attributeControllers.containsValue(controller)) {
      _calculateProductNameAndVolume(i);  // –° –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º index!
      break;
    }
  }
}

void _generateProductName(int index) {
  // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç _products[index].attributeControllers
  final product = _products[index];
  for (final attribute in product.template!.attributes) {
    final value = product.attributeControllers[attribute.variable]?.text ?? '';
  }
}
```

### 4Ô∏è‚É£ –û–ë–ù–û–í–õ–ï–ù–ò–ï –≠–ö–†–ê–ù–ê (–û–¢–õ–ò–ß–ò–ï ‚Ññ3)

**–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:**
```dart
void _calculateNameAndVolume() {
  // –ü—Ä—è–º–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
  _nameController.text = _generateProductName();
  _calculatedVolumeController.text = _calculateVolume();
  // setState() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å–ª—É—à–∞—Ç–µ–ª—è–º–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
}
```

**–¢–æ–≤–∞—Ä—ã –≤ –ø—É—Ç–∏:**
```dart
void _calculateProductNameAndVolume(int index) {
  final product = _products[index];
  
  // –°–æ–∑–¥–∞—ë–º –ù–û–í–´–ô –æ–±—ä–µ–∫—Ç ProductFormData
  setState(() {
    _products[index] = ProductFormData(
      // ... –∫–æ–ø–∏—Ä—É–µ–º –≤—Å–µ –ø–æ–ª—è ...
      name: _generateProductName(index),  // –ù–æ–≤–æ–µ –∏–º—è
      calculatedVolume: _calculateProductVolume(index),  // –ù–æ–≤—ã–π –æ–±—ä—ë–º
    );
  });
}
```

### 5Ô∏è‚É£ –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï (–û–î–ò–ù–ê–ö–û–í–û–ï)

**–û–±–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é —Ä–∞–∑–±–æ—Ä–∞:**

```dart
Widget _buildProductHeader(String fullName) {
  if (fullName.contains(':')) {
    final parts = fullName.split(':');
    final productName = parts[0].trim();  // "–î–æ—Å–∫–∞"
    final characteristics = parts.sublist(1).join(':').trim();  // "20 x 30, –°–æ—Å–Ω–∞"
    
    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –Ω–∞ –¥–≤–µ —Å—Ç—Ä–æ–∫–∏
    return Column(
      children: [
        Text('$productName:'),  // "–î–æ—Å–∫–∞:" - –∂–∏—Ä–Ω—ã–π
        Text(characteristics),   // "20 x 30, –°–æ—Å–Ω–∞" - —Å–µ—Ä—ã–π
      ],
    );
  }
}
```

---

## üîç –¢–ê–ë–õ–ò–¶–ê –û–¢–õ–ò–ß–ò–ô

| –ê—Å–ø–µ–∫—Ç | –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ | –¢–æ–≤–∞—Ä—ã –≤ –ø—É—Ç–∏ |
|--------|-----------|-----------------|
| **–§–∞–∑–∞ 1: –í—ã–±–æ—Ä —à–∞–±–ª–æ–Ω–∞** | `_onTemplateChanged()` | `_onProductTemplateChanged(index)` |
| **–§–∞–∑–∞ 2: –ó–∞–≥—Ä—É–∑–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤** | `_loadTemplateAttributes()` | `_loadProductTemplateAttributes(index)` |
| **–§–∞–∑–∞ 3: –ü–µ—Ä–µ—Å—á—ë—Ç –∏–º–µ–Ω–∏** | `_calculateNameAndVolume()` | `_calculateProductNameAndVolume(index)` |
| **–§–∞–∑–∞ 4: –ê–ª–≥–æ—Ä–∏—Ç–º** | `_generateProductName()` | `_generateProductName(index)` |
| **–ö–∞–∫ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è** | 1 —Ä–∞–∑ | N —Ä–∞–∑ (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ –∫–∞–∂–¥—ã–π —Ç–æ–≤–∞—Ä) |
| **–†–µ–∑—É–ª—å—Ç–∞—Ç** | –í `_nameController.text` | –í `_products[index].name` |

---

## üìÅ –ì–î–ï –ù–ê–•–û–î–Ø–¢–°–Ø –§–ê–ô–õ–´

### –°–æ–∑–¥–∞–Ω–∏–µ –∏–º–µ–Ω–∏ (—Ñ–æ—Ä–º—ã):
- ‚úÖ **–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ**: `lib/features/products_inflow/presentation/pages/product_inflow_form_page.dart` (—Å—Ç—Ä–æ–∫–∏ 210-237)
- ‚úÖ **–¢–æ–≤–∞—Ä—ã –≤ –ø—É—Ç–∏**: `lib/features/products_in_transit/presentation/pages/product_in_transit_form_page.dart` (—Å—Ç—Ä–æ–∫–∏ 1188-1216)

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–º–µ–Ω–∏ (—Å–ø–∏—Å–∫–∏):
- ‚úÖ **–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ**: `lib/features/products_inflow/presentation/pages/product_inflow_list_page.dart` (—Å—Ç—Ä–æ–∫–∏ 531-574)
- ‚úÖ **–¢–æ–≤–∞—Ä—ã –≤ –ø—É—Ç–∏**: `lib/features/products_in_transit/presentation/pages/product_in_transit_list_page.dart` (—Å—Ç—Ä–æ–∫–∏ 529-573)

---

## üí° –ö–û–î: –°–£–¢–¨ –û–¢–õ–ò–ß–ò–Ø

### –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ (–ø—Ä–æ—Å—Ç–æ–π —Å–ª—É—á–∞–π)
```dart
// 1 –¢–û–í–ê–† = 1 set –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
String _generateProductName() {
  for (final attribute in _selectedTemplate!.attributes) {
    final value = _attributeControllers[attribute.variable]?.text;
    // ... –æ–±—Ä–∞–±–æ—Ç–∫–∞
  }
}
```

### –¢–æ–≤–∞—Ä—ã –≤ –ø—É—Ç–∏ (—Å–ª–æ–∂–Ω—ã–π —Å–ª—É—á–∞–π)
```dart
// N –¢–û–í–ê–†–û–í = N sets –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
String _generateProductName(int index) {
  final product = _products[index];  // ‚Üê –ø–æ–ª—É—á–∞–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–æ–≤–∞—Ä
  
  for (final attribute in product.template!.attributes) {
    final value = product.attributeControllers[attribute.variable]?.text;
    // ... –æ–±—Ä–∞–±–æ—Ç–∫–∞
  }
}
```

---

## üéØ –ü–†–ê–ö–¢–ò–ß–ï–°–ö–ò–ô –ü–†–ò–ú–ï–†

### –°—Ü–µ–Ω–∞—Ä–∏–π: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞—ë—Ç "–î–æ—Å–∫—É: 20 x 30, –°–æ—Å–Ω–∞"

#### –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:
```
1. –í—ã–±–∏—Ä–∞–µ–º —à–∞–±–ª–æ–Ω "–î–æ—Å–∫–∞"
   ‚Üí _onTemplateChanged()
   ‚Üí _loadTemplateAttributes()
   
2. –í–≤–æ–¥–∏–º "20" –≤ –ø–æ–ª–µ "–î–ª–∏–Ω–∞"
   ‚Üí —Å–ª—É—à–∞—Ç–µ–ª—å –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
   ‚Üí _onAttributeChanged()
   ‚Üí _calculateNameAndVolume()
   ‚Üí _generateProductName()
   ‚Üí _nameController.text = "–î–æ—Å–∫–∞: 20..."
   
3. –í–≤–æ–¥–∏–º "30" –≤ –ø–æ–ª–µ "–®–∏—Ä–∏–Ω–∞"
   ‚Üí _onAttributeChanged()
   ‚Üí _calculateNameAndVolume()
   ‚Üí _generateProductName()
   ‚Üí _nameController.text = "–î–æ—Å–∫–∞: 20 x 30..."
   
4. –í—ã–±–∏—Ä–∞–µ–º "–°–æ—Å–Ω–∞" –≤ –ø–æ–ª–µ "–ú–∞—Ç–µ—Ä–∏–∞–ª"
   ‚Üí _onAttributeChanged()
   ‚Üí _calculateNameAndVolume()
   ‚Üí _generateProductName()
   ‚Üí _nameController.text = "–î–æ—Å–∫–∞: 20 x 30, –°–æ—Å–Ω–∞"  ‚Üê –ì–û–¢–û–í–û
```

#### –¢–æ–≤–∞—Ä—ã –≤ –ø—É—Ç–∏ (—Ç–æ–≤–∞—Ä 0):
```
1. –í—ã–±–∏—Ä–∞–µ–º —à–∞–±–ª–æ–Ω "–î–æ—Å–∫–∞" –¥–ª—è —Ç–æ–≤–∞—Ä–∞ 0
   ‚Üí _onProductTemplateChanged(0, templateId)
   ‚Üí _loadProductTemplateAttributes(0, templateId)
   
2. –í–≤–æ–¥–∏–º "20" –≤ –ø–æ–ª–µ "–î–ª–∏–Ω–∞" —Ç–æ–≤–∞—Ä–∞ 0
   ‚Üí —Å–ª—É—à–∞—Ç–µ–ª—å –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
   ‚Üí _onProductAttributeChanged(controller)
   ‚Üí –Ω–∞—Ö–æ–¥–∏–º —á—Ç–æ —ç—Ç–æ —Ç–æ–≤–∞—Ä 0
   ‚Üí _calculateProductNameAndVolume(0)
   ‚Üí _generateProductName(0)
   ‚Üí setState({ _products[0].name = "–î–æ—Å–∫–∞: 20..." })
   
3. –í–≤–æ–¥–∏–º "30" –≤ –ø–æ–ª–µ "–®–∏—Ä–∏–Ω–∞" —Ç–æ–≤–∞—Ä–∞ 0
   ‚Üí _onProductAttributeChanged(controller)
   ‚Üí _calculateProductNameAndVolume(0)
   ‚Üí _generateProductName(0)
   ‚Üí setState({ _products[0].name = "–î–æ—Å–∫–∞: 20 x 30..." })
   
4. –í—ã–±–∏—Ä–∞–µ–º "–°–æ—Å–Ω–∞" –≤ –ø–æ–ª–µ "–ú–∞—Ç–µ—Ä–∏–∞–ª" —Ç–æ–≤–∞—Ä–∞ 0
   ‚Üí _onProductAttributeChanged(controller)
   ‚Üí _calculateProductNameAndVolume(0)
   ‚Üí _generateProductName(0)
   ‚Üí setState({ _products[0].name = "–î–æ—Å–∫–∞: 20 x 30, –°–æ—Å–Ω–∞" })  ‚Üê –ì–û–¢–û–í–û

5. –û–î–ù–û–í–†–ï–ú–ï–ù–ù–û –º–æ–∂–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç–æ–≤–∞—Ä–æ–º 1:
   ‚Üí –í—ã–±–∏—Ä–∞–µ–º —à–∞–±–ª–æ–Ω "–ö—Ä–∞—Å–∫–∞" –¥–ª—è —Ç–æ–≤–∞—Ä–∞ 1
   ‚Üí _onProductTemplateChanged(1, templateId)
   ‚Üí _loadProductTemplateAttributes(1, templateId)
   ‚Üí ... –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ...
```

---

## üìö –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ú–ê–¢–ï–†–ò–ê–õ–´

–î–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å–º.:
- üìÑ `COMPARISON_PRODUCT_NAME_CREATION.md` - –î–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥–∏–∞–≥—Ä–∞–º–º–∞–º–∏
- üìÑ `PRODUCT_NAME_REFACTORING_GUIDE.md` - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É –∫–æ–¥–∞

---

## ‚ú® –ö–õ–Æ–ß–ï–í–´–ï –í–´–í–û–î–´

| # | –í—ã–≤–æ–¥ |
|---|-------|
| 1 | ‚úÖ –ê–ª–≥–æ—Ä–∏—Ç–º **–∏–¥–µ–Ω—Ç–∏—á–µ–Ω** - –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —Å–ø–æ—Å–æ–± —Å–æ–±—Ä–∞—Ç—å –∏–º—è |
| 2 | ‚ùå –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ **–æ—Ç–ª–∏—á–∞–µ—Ç—Å—è** - –ø—Ä–æ—Å—Ç–æ–π —Å–ª—É—á–∞–π vs. —Å–ª–æ–∂–Ω—ã–π |
| 3 | üí° –ú–æ–∂–Ω–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å - –≤—ã–Ω–µ—Å—Ç–∏ –≤ –æ–±—â–∏–π –∫–ª–∞—Å—Å `ProductNameGenerator` |
| 4 | üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–¥–∏–Ω–∞–∫–æ–≤ - –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ |
| 5 | üöÄ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è - —Å–æ–∑–¥–∞—Ç—å unit —Ç–µ—Å—Ç—ã –¥–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ |
